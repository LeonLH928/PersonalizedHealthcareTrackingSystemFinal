<Window x:Class="PersonalizedHealthcareTrackingSystemFinal.Views.LoginWindow"
        x:Name="RootWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PersonalizedHealthcareTrackingSystemFinal.Helpers"
        mc:Ignorable="d"
        Title="Personalized Healthcare System | Login" 
        Height="600" Width="800"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="NoResize"
        Icon="/Resources/Logo/logo.ico"
        BorderThickness="0"
        
    FontFamily="/PersonalizedHealthcareTrackingSystemFinal;component/Resources/Fonts/#Poppins">

    <Border Background="#11161F" CornerRadius="20" BorderThickness="1" BorderBrush="#333">
        <Grid>
            <StackPanel VerticalAlignment="Center" 
                        HorizontalAlignment="Center" 
                        Width="450">

                <Image Source="/Resources/Logo/icon.png" Width="100" Height="100" Margin="0,0,0,20"/>

                <TextBlock Text="PERSONALIZED HEALTHCARE TRACKING SYSTEM" 
                           Foreground="White" FontSize="18" FontWeight="Bold" 
                           HorizontalAlignment="Center" TextAlignment="Center" TextWrapping="Wrap"
                           Margin="0,0,0,5"/>

                <TextBlock Text="Your Health, Your Data, Your Control" 
                           Foreground="{StaticResource TextGray}" FontSize="14" FontStyle="Italic"
                           HorizontalAlignment="Center" Margin="0,0,0,40"/>

                <!-- Error Message -->
                <TextBlock Text="{Binding ErrorMessage}"
                           Foreground="#E81123"
                           FontSize="12"
                           TextWrapping="Wrap"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,15"
                           Visibility="{Binding HasError, Converter={StaticResource BoolToVisibilityConverter}}"/>

                <TextBox Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}"
                         Style="{StaticResource RoundedTextBoxStyle}" 
                         Tag="Username or Email"
                         Height="50" Margin="0,0,0,20" Padding="15,12,20,12" FontFamily="Poppins"/>

                <Grid Margin="0,0,0,10">
                    <PasswordBox x:Name="pwdBox"
                                 Style="{StaticResource RoundedPasswordBoxStyle}"
                                 Tag="Password"
                                 Height="50"
                                 Padding="15,12,20,12"
                                 PasswordChanged="pwdBox_PasswordChanged"/>

                    <TextBox x:Name="txtVisiblePassword"
                             Style="{StaticResource RoundedTextBoxStyle}"
                             Tag="Password"
                             Height="50"
                             Visibility="Collapsed"
                             Padding="15,12,20,12"
                             TextChanged="txtVisiblePassword_TextChanged"/>

                    <ToggleButton x:Name="btnToggleShow"
                                  IsTabStop="False"
                                  HorizontalAlignment="Right" VerticalAlignment="Center"
                                  Width="30" Height="30" Margin="0,0,15,0"
                                  Background="Transparent" BorderThickness="0" Cursor="Hand"
                                  Checked="ShowPassword_Checked" Unchecked="ShowPassword_Unchecked">
                        <ToggleButton.Template>
                            <ControlTemplate TargetType="ToggleButton">
                                <Border Background="Transparent">
                                    <TextBlock x:Name="txtIcon" Text="👁" FontSize="16" Foreground="{StaticResource TextGray}" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsChecked" Value="True">
                                        <Setter TargetName="txtIcon" Property="Foreground" Value="{StaticResource PrimaryTeal}"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="txtIcon" Property="Opacity" Value="0.8"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </ToggleButton.Template>
                    </ToggleButton>
                </Grid>

                <TextBlock Text="Forget Password?" 
                           Foreground="{StaticResource TextGray}"
                           TextDecorations="Underline" 
                           Cursor="Hand" 
                           HorizontalAlignment="Right" 
                           Margin="0,0,5,30"
                           FontSize="12">
                    <TextBlock.Style>
                        <Style TargetType="TextBlock">
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Foreground" Value="{StaticResource PrimaryTeal}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>

                <Button Command="{Binding LoginCommand}" 
                        Content="LOG IN" 
                        Style="{StaticResource TealButtonStyle}" 
                        Height="50" Margin="0,0,0,25"
                        IsDefault="True"/>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <TextBlock Text="Don't have an account? " 
                               Foreground="{StaticResource TextGray}"
                               FontSize="13"/>
                    <TextBlock Text="Sign Up" 
                               Foreground="{StaticResource PrimaryTeal}"
                               TextDecorations="Underline" 
                               FontWeight="Bold" 
                               FontSize="13"
                               Cursor="Hand"
                               MouseLeftButtonDown="SignUpLink_Click">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Foreground" Value="#26a58c"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </StackPanel>

            </StackPanel>

            <StackPanel Orientation="Horizontal" 
                        VerticalAlignment="Top" 
                        HorizontalAlignment="Right" 
                        Margin="0,10,15,0">

                <Button Content="—" 
                        Style="{StaticResource WindowControlButtonStyle}"
                        Command="{Binding MinimizeAppCommand}"
                        CommandParameter="{Binding ElementName=RootWindow}"/>

                <Button Content="✕" 
                        Style="{StaticResource CloseButtonStyle}"
                        Command="{Binding CloseAppCommand}"
                        CommandParameter="{Binding ElementName=RootWindow}"/>
            </StackPanel>

            <Grid Background="#AA000000" 
                  Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}" Margin="10,0,15,10">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <ProgressBar IsIndeterminate="True" 
                                 Width="100" 
                                 Height="5" 
                                 Foreground="{StaticResource PrimaryTeal}"
                                 Background="#333"
                                 Margin="0,0,0,15"/>
                    <TextBlock Text="Logging in..." 
                               Foreground="White" 
                               FontSize="14"
                               HorizontalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</Window>